<?xml version="1.0"?>
<ESPublicQuery xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <SQL><![CDATA[SELECT ESFIDocumentTrade.fTradeAccountGID AS fTradeAccountGID, 
       ESFIDocumentTrade.ADRegistrationDate AS ADRegistrationDate, 
       ESFIDocumentTrade.ADCode AS ADCode, 
       FK_ESFIDocumentTrade_ESFITradeAccount.Code AS Code, 
       FK_ESFIDocumentTrade_ESFITradeAccount.Name AS Name, 
       ESFIDocumentTrade.NetValue AS NetValue, 
       ESFIDocumentTrade.VATValue AS VATValue, 
       ESFIDocumentTrade.PayableAmount AS PayableAmount, 
       ESFIDocumentTrade.ADAlternativeCode AS ADAlternativeCode, 
       ESFIDocumentTrade.ADReferenceCode AS ADReferenceCode, 
       FK_ESGOSites_ESFIDocumentTrade_DeliverySite.Code AS ShipCode, 
       FK_ESGOSites_ESFIDocumentTrade_DeliverySite.Description AS ShipDescr
FROM ESFIDocumentTrade AS ESFIDocumentTrade 
     INNER JOIN ESFITradeAccount AS FK_ESFIDocumentTrade_ESFITradeAccount
       ON ESFIDocumentTrade.fTradeAccountGID = FK_ESFIDocumentTrade_ESFITradeAccount.GID 
     LEFT JOIN ESGOSites AS FK_ESGOSites_ESFIDocumentTrade_ADSite
       ON ESFIDocumentTrade.fADSiteGID = FK_ESGOSites_ESFIDocumentTrade_ADSite.GID 
     LEFT JOIN ESFIDocumentType AS FK_ESFIDocumentTrade_ESFIDocumentType
       ON ESFIDocumentTrade.fADDocumentTypeGID = FK_ESFIDocumentTrade_ESFIDocumentType.GID 
     LEFT JOIN ESFIADTransitionState AS FK_ESFIDocumentTrade_ESFIADTransitionState
       ON ESFIDocumentTrade.GID = FK_ESFIDocumentTrade_ESFIADTransitionState.GID 
     LEFT JOIN ESFIDocumentUpdateProfile AS FK_ESFIDocumentTrade_ESFIDocumentUpdateProfile
       ON ESFIDocumentTrade.fADDocumentUpdateProfileGID = FK_ESFIDocumentTrade_ESFIDocumentUpdateProfile.GID 
     LEFT JOIN ESGOProject AS FK_ESFIDocumentTrade_ESGOProject
       ON ESFIDocumentTrade.fADProjectGID = FK_ESFIDocumentTrade_ESGOProject.GID 
     LEFT JOIN ESGOSites AS FK_ESGOSites_ESFIDocumentTrade_DeliverySite
       ON ESFIDocumentTrade.fDeliverySiteGID = FK_ESGOSites_ESFIDocumentTrade_DeliverySite.GID 
WHERE (ESFIDocumentTrade.fCompanyCode = ##(ESCOMPANY))
       AND (FK_ESFIDocumentTrade_ESFIDocumentType.MenuEntry = 2)
       AND (ESEqual(FK_ESFIDocumentTrade_ESFITradeAccount.Code, @Code))
       AND (ESEQUAL(FK_ESFIDocumentTrade_ESFITradeAccount.Name,@Name,FK_ESFIDocumentTrade_ESFITradeAccount.SOUNDNAME))
       AND ((ESEqual(FK_ESFIDocumentTrade_ESFIDocumentType.Code, @Code2))
       OR (ESEqual(FK_ESFIDocumentTrade_ESFIDocumentType.InternationalID, @Code2)))
       AND (ESEqual(FK_ESGOSites_ESFIDocumentTrade_ADSite.Code, @Code1))
       AND (ESEqual(ESFIDocumentTrade.ADRegistrationDate, @ADRegistrationDate))
       AND (ESEqual(ESFIDocumentTrade.ADCode, @ADCode))
       AND ((ESFIDocumentTrade.TradeAccountType = 0)
       OR (ESFIDocumentTrade.TradeAccountType = 2))
       AND (ESEqual(ESFIDocumentTrade.ESUCreated, @ESUCreated))
       AND (ESEqual(ESFIDocumentTrade.PayableAmount, @PayableAmmount1))
       AND (FK_ESFIDocumentTrade_ESFIDocumentType.InternationalID = 'ES.12000.01')
       AND (FK_ESGOSites_ESFIDocumentTrade_DeliverySite.Code = ISNULL((select TOP 1 Stringfield1 from ESGOUser where UserId=##(ESUSER)),FK_ESGOSites_ESFIDocumentTrade_DeliverySite.Code))
       AND (ESFIDocumentTrade.fTradeAccountGID = (select dbo.GetTradeAccountGID(##(ESUSER),##(ESCOMPANY),##(ESBRANCH))))
      
]]></SQL>
  <SQLforPaging><![CDATA[]]></SQLforPaging>
  <Table>ESFIDocumentTrade</Table>
  <Params>
    <Param>
      <ID>Code</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>11AA2299-3F5E-4B2A-B530-6222866A7601</ODSTag>
    </Param>
    <Param>
      <ID>Name</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>7699C12E-3B5F-47E8-B509-7AF97F4560B1</ODSTag>
    </Param>
    <Param>
      <ID>Code2</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>B9B54954-825F-48C8-8007-4EFC914EBE3A</ODSTag>
    </Param>
    <Param>
      <ID>Code1</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>8AF8DB23-B52A-4CA7-BF04-3E1D97B58BEA</ODSTag>
    </Param>
    <Param>
      <ID>ADRegistrationDate</ID>
      <Type>Entersoft.Framework.Platform.ESDateRange, QueryProcess</Type>
      <ODSTag>7F9E950D-6C69-4172-842A-BF34764F9464</ODSTag>
    </Param>
    <Param>
      <ID>ADCode</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>3F6D6906-2679-43A5-9CB5-042408532BD9</ODSTag>
    </Param>
    <Param>
      <ID>ESUCreated</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>A6E1A559-697C-48C4-A205-7958BC4EE000</ODSTag>
    </Param>
    <Param>
      <ID>PayableAmmount1</ID>
      <Type>System.String, mscorlib</Type>
      <ODSTag>7699C12E-3B5F-47E8-B509-7AF97F4560B1</ODSTag>
    </Param>
  </Params>
</ESPublicQuery>