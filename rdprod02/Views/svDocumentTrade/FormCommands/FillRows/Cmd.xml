<?xml version="1.0" encoding="UTF-8"?>
<ShowMultiFormFOCommand RootNodeType="Entersoft.Framework.Windows.CustomCommands.ShowMultiFormFOCommand, ESCtxCmds" Version="2" CGID="c9ee7dea-999a-495d-9435-dc51e5465c94" HasMenuEntry="False" Identity="True" uiless_in_transaction="True">
  <ParamsNode CGID="30762785-5d8d-47aa-816c-85db4167c905" ControlsWidth="200">
    <ShowConditions CGID="72e266c8-6629-4f73-9dcc-113f2dd0538c" />
    <CheckConditions CGID="344d4234-0907-405b-a039-2cd65b31cfe1" />
    <Param ID="payload" CaptionID="61255de8-509c-4b92-8bf5-4f17e68a26f5" MultiSelect="False">
      <ExtraNode CGID="3fcba267-d56d-4239-b951-dd115ba15f8e">
        <DefaultValueNode CGID="468fa1e9-568a-4721-a34c-da9fe7061792">
          <Supplier CGID="d97395d9-c3c6-4103-bb1f-74ae53ef0984">
            <TextFormatValue>[
    {
        "code": "PJM",
        "Age": 30,
        "City": "New York"
    },
    {
        "code": "PJM",
        "Age": 30,
        "City": "New York"
    }
]
</TextFormatValue>
          </Supplier>
        </DefaultValueNode>
      </ExtraNode>
    </Param>
    <ParamFile Filename="CommandParams.xml">
      <Filter ID="CommandParams" Caption="" CaptionID="6fb4f58e-a8f5-4cc0-9388-b682a4a14521" Version="1" FilterType="-1" AutoExecInterval="0" DrillDown="False" DrillColName="" LoadAllData="False" ShowAllCategory="False">
        <Params>
          <Param ID="payload" AA="1" AddedByUser="True">
            <Caption>payload</Caption>
            <CaptionID>61255de8-509c-4b92-8bf5-4f17e68a26f5</CaptionID>
            <Tooltip>
            </Tooltip>
            <MultiValued>True</MultiValued>
            <DefaultValue />
            <ControlType>ctString</ControlType>
            <ParameterType>System.String, mscorlib</ParameterType>
            <Visible>True</Visible>
            <Visibility>Always</Visibility>
            <Required>False</Required>
            <Precision>3</Precision>
            <ODSTag>
            </ODSTag>
            <Tags>
            </Tags>
          </Param>
        </Params>
        <ESReports />
        <Translations>
          <ESCaptionsDS xmlns="http://tempuri.org/ESCaptionsDS.xsd">
            <Captions>
              <ID>61255de8-509c-4b92-8bf5-4f17e68a26f5</ID>
              <Suffix>C</Suffix>
              <LangID>el</LangID>
              <Caption>payload</Caption>
            </Captions>
          </ESCaptionsDS>
        </Translations>
      </Filter>
    </ParamFile>
  </ParamsNode>
  <Profiles CGID="388d45a7-3901-48a5-bf90-ecf37fba5034">
    <Profile CGID="5b173603-8c5e-40f1-a397-606945bdde26" UILess="True" Identity="True" Save="False">
      <SourceEntity EntityID="ESFIDocumentTrade" />
      <TargetEntity EntityID="ESFIDocumentTrade" />
      <SaveExpression CGID="97642fab-bbc4-472d-b861-2970d1237282">
        <Supplier>
          <EnumValue Type="Entersoft.Framework.Platform.Helper.SaveEnum, ESEntity" Value="SAVE_AND_ACTIONS" />
        </Supplier>
      </SaveExpression>
      <RootRule CGID="cb74b4a2-2224-4c8f-af43-6bfdeaa848a7" Source="ESFIDocumentTrade" Target="ESFIDocumentTrade" TargetKey="GID">
        <ExecuteSimpleConditions CGID="c0d075d1-3dd9-42f4-963e-32bd3ba75519" />
        <Variables CGID="1d298258-b914-4842-97e7-6dab83a3e807" />
        <Rules CGID="56268540-eac4-40f8-896b-9fc303dc55a7">
          <Rule CGID="90f70d8f-ff01-458a-b238-0de956963553" Target="FK_ESFILineItem_ESFIDocumentTrade">
            <ExecuteSimpleConditions CGID="bc52d61f-af0d-49d6-92ae-d3850a8c0cda" />
            <Variables CGID="18e3fada-72e6-41e6-874f-4ecdc46fce08" />
            <Rules CGID="f59d9866-053e-4248-bb7a-f0ed3be6696e" />
            <Conditions CGID="a011b5af-6f0f-41b0-8697-c6f5334e0c72" />
            <Assignments CGID="e36bdc57-44fa-4434-8fff-a38da4a4d299">
              <Assign CGID="2491f845-b26b-4054-93ec-5ee88f15e79e" Column="LineType">
                <Supplier>
                  <EnumValue Type="Entersoft.Framework.Platform.ESFILineItem_LineType_LineType, ESSessionCtx" Value="Normal" />
                </Supplier>
                <Conditions CGID="73e5cb77-c8bc-4f22-b8a0-31e76a88fbd5" />
              </Assign>
              <Assign CGID="3cfe2a93-aff4-436a-b2e8-53eb65688f24" Column="fItemGID">
                <Supplier CGID="540a6d71-0903-4c84-8d4b-284aa43b36c4">
                  <Param CGID="20f3582b-37ae-4e40-987c-9b484021ce7f" ParamName="$datarows">
                    <Supplier>
                      <MultiplierValue>Test</MultiplierValue>
                    </Supplier>
                  </Param>
                  <ExpressionValue>Dim code as DataRow = Directcast($datarows, DataRow)
Dim codeValue As String = code("code").ToString()
Return codeValue
</ExpressionValue>
                </Supplier>
                <Conditions CGID="ab0d5d35-d53c-4b9a-a7fa-7c1062f606bf" />
              </Assign>
            </Assignments>
            <OrderByNodes CGID="78639a10-4f82-46ec-a3b5-12f8255fc48a" />
            <GroupByNodes CGID="f8ca83ff-08fd-440f-8227-27fd50e81045">
              <GroupAtMostEntries CGID="61b3e80b-3010-4a90-9768-d90e95389e44">
                <Supplier>
                  <ConstantValue>0</ConstantValue>
                </Supplier>
              </GroupAtMostEntries>
            </GroupByNodes>
            <MultiplyByNodes CGID="326a9aa2-e0a2-4347-9a06-b80af68735b9">
              <MultiplyBy CGID="845599c5-6576-489a-bc46-b752297f0ece" MultiplyID="Test">
                <Supplier CGID="93f6b059-7514-4f82-999c-eb19357982fd">
                  <Param CGID="ee4e2306-3906-4bd1-b885-d7d3057f234c" ParamName="$jsonparam">
                    <Supplier>
                      <CommandParamValue>payload</CommandParamValue>
                    </Supplier>
                  </Param>
                  <ExpressionValue>#references Newtonsoft.Json.dll
#Imports Newtonsoft.Json
#Imports Newtonsoft.Json.Linq
#references System.Core.dll

' Your JSON string
Dim json As String = $jsonparam.ToString()

' Parse the JSON string into a JArray (array of objects)
Dim jArray As JArray = JArray.Parse(json)

' Create a DataTable
Dim dataTable As New DataTable()

' Assuming the JSON array contains objects with the same structure,
' you can use the first object in the array to define the columns
If jArray.Count &gt; 0 Then
    Dim firstObject As JObject = CType(jArray(0), JObject)
    
    For Each [property] As JProperty In firstObject.Properties()
        dataTable.Columns.Add([property].Name, GetType(String))
    Next

    ' Add rows with the JSON values to the DataTable
    For Each jObject As JObject In jArray
        Dim row As DataRow = dataTable.NewRow()
        For Each [property] As JProperty In jObject.Properties()
            row([property].Name) = [property].Value.ToString()
        Next
        dataTable.Rows.Add(row)
    Next
End If

' Now, dataTable contains the data from the JSON array in tabular form
Return dataTable.Rows
</ExpressionValue>
                </Supplier>
              </MultiplyBy>
            </MultiplyByNodes>
            <RowActions CGID="00ac2e0f-6d16-43b5-bb8d-0ce563e9cdff" />
          </Rule>
        </Rules>
        <Conditions CGID="de1c8bfd-65e6-45e5-94f6-7f75feb6faa3" />
        <Assignments CGID="6ce1ba7f-73b3-40aa-8979-79c6adeecfba">
          <Assign CGID="578ac522-a6e7-4dea-9488-8277b849dd1f" Column="GID">
            <Supplier>
              <SourceValue>GID</SourceValue>
            </Supplier>
            <Conditions CGID="09eff464-ebb6-4d17-a7d7-eb98c29fbb2f" />
          </Assign>
        </Assignments>
        <OrderByNodes CGID="708e9212-7162-4645-8559-c21c908e54e9" />
        <GroupByNodes CGID="e961af67-972e-4921-85d2-f0ff35b233b5">
          <GroupAtMostEntries CGID="48e24152-4935-4002-ab02-dc0a357d6269">
            <Supplier>
              <ConstantValue>0</ConstantValue>
            </Supplier>
          </GroupAtMostEntries>
        </GroupByNodes>
        <MultiplyByNodes CGID="fa933931-ae20-4aef-883a-714318563719" />
        <RowActions CGID="b485fe14-e409-4206-bd14-2655f5a5bc51" />
      </RootRule>
      <MapExceptions CGID="bdbcb650-87a4-4469-bdd4-f0887ea4563b" />
      <LoginCredentials CGID="25ee6e46-1686-4011-a02d-7cb7e1362cb6" />
    </Profile>
  </Profiles>
  <ExecuteConditions CGID="c3118e28-f6e6-4404-bdeb-183600e13d85" />
  <ShowSimpleConditions CGID="0f86d8d5-35de-4648-abe4-c6e886cd7118" />
  <ExecuteMessageConditions CGID="81f88286-7cbc-4533-8f2b-36fc10e0d28e" />
  <ValidityConditions CGID="6b252e5b-d6a6-4194-bf93-f3cae4e0f078" />
  <UserGroups>
  </UserGroups>
  <CommandAvailability />
  <SourceEntity EntityID="ESFIDocumentTrade" />
  <Translations>
    <ESCaptionsDS xmlns="http://tempuri.org/ESCaptionsDS.xsd">
  <Captions>
    <ID>c9ee7dea-999a-495d-9435-dc51e5465c94</ID>
    <Suffix>Caption</Suffix>
    <LangID>el</LangID>
    <Caption>FillRows</Caption>
  </Captions>
  <Captions>
    <ID>61b3e80b-3010-4a90-9768-d90e95389e44</ID>
    <Suffix>Title</Suffix>
    <LangID>el</LangID>
    <Caption>Maximum Entries</Caption>
  </Captions>
  <Captions>
    <ID>48e24152-4935-4002-ab02-dc0a357d6269</ID>
    <Suffix>Title</Suffix>
    <LangID>el</LangID>
    <Caption>Maximum Entries</Caption>
  </Captions>
  <Captions>
    <ID>845599c5-6576-489a-bc46-b752297f0ece</ID>
    <Suffix>Title</Suffix>
    <LangID>el</LangID>
    <Caption>Test</Caption>
  </Captions>
</ESCaptionsDS>
  </Translations>
</ShowMultiFormFOCommand>